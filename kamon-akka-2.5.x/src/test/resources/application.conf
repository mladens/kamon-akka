akka {
  loglevel = INFO
  loggers = [ "akka.event.slf4j.Slf4jLogger" ]
  logger-startup-timeout = 30s

  actor {
    serialize-messages=on

    deployment {
      /picking-the-right-dispatcher-in-pool-router {
        router = round-robin-pool
        resizer = {
          lower-bound = 5
          upper-bound = 64
          messages-per-resize = 20
        }
      }

      "/picking-the-right-dispatcher-in-pool-router/*" {
        dispatcher = custom-dispatcher
      }
    }
  }
}

custom-dispatcher {
  executor = "thread-pool-executor"
  type = PinnedDispatcher
}

kamon {
  akka {
    filters {

      actors {
        track {
          includes = [ "*/user/tracked-*", "*/user/measuring-*", "*/user/clean-after-collect", "*/user/stop", "*/user/repointable*", "*/" ]
          excludes = [ "*/user/tracked-explicitly-excluded", "*/user/non-tracked-actor" ]
        }
        trace {
          includes = [ "*/user/traced*" ]
          excludes = []
        }
      }

      routers {
        includes = [ "*/user/tracked-*", "*/user/measuring-*", "*/user/cleanup-*", "*/user/picking-*", "*/user/stop-*" ]
        excludes = [ "*/user/tracked-explicitly-excluded-*"]
      }

      dispatchers {
        includes = [ "**" ]
        excludes = [ "explicitly-excluded" ]
      }

      // group-of-actors.includes has type LIST rather than OBJECT
      groups {
        group-of-actors {
          includes = ["*/user/group-of-actors-*"]
          excludes = []
        }
        group-of-routees {
          includes = ["*/user/group-of-routees*"]
          excludes = []
        }

      }
    }
  }

  metric {
    instrument-factory.custom-settings {
      "akka.actor.mailbox-size" {
        sample-interval = 1 millisecond
      }

      "akka.group.members" {
        sample-interval = 1 millisecond
      }
    }
  }

  util {
    filters = {
    }
  }

  trace.sampler = "always"

  default-instrument-settings {
    gauge.refresh-interval = 1 hour
    min-max-counter.refresh-interval = 1 hour
  }

  instrument-settings {
    akka-actor.mailbox-size.refresh-interval = 1 hour
  }
}

explicitly-excluded {
  type = "Dispatcher"
  executor = "fork-join-executor"
}

tracked-fjp {
  type = "Dispatcher"
  executor = "fork-join-executor"

  fork-join-executor {
    parallelism-min = 8
    parallelism-factor = 100.0
    parallelism-max = 22
  }
}

tracked-tpe {
  type = "Dispatcher"
  executor = "thread-pool-executor"

  thread-pool-executor {
    core-pool-size-min = 7
    core-pool-size-factor = 100.0
    max-pool-size-factor  = 100.0
    max-pool-size-max = 21
    core-pool-size-max = 21
  }
}